<div class="sigma-container">
  <div class="sigma-main-layout">
    <!-- Sidebar -->
    <aside class="sigma-sidebar">
      <h2>Panel de Control</h2>

      <!-- Upload Section -->
      <div class="section">
        <div class="section-title">Cargar Imagen A√©rea</div>
        <div class="upload-area" (click)="fileInput.click()">
          <div class="upload-icon">üì§</div>
          <p>Arrastra aqu√≠ tu archivo TIFF</p>
          <p class="upload-hint">o haz clic para seleccionar</p>
          <div class="upload-file-name" [class.active]="uploadedFile">{{ uploadedFile || 'Ning√∫n archivo cargado' }}</div>
        </div>
        <input #fileInput type="file" accept=".tiff,.tif" (change)="onFileSelect($event)" style="display: none;">
      </div>

      <!-- Hovered region info -->
      <div class="section" *ngIf="hoveredCell">
        <div class="section-title">Zona Resaltada</div>
        <div class="hovered-region">
          <strong>üéØ {{ hoveredCell.name }}</strong>
          <p><strong>Tipo:</strong> {{ hoveredCell.type }}</p>
          <p><strong>√Årea:</strong> {{ hoveredCell.area }}</p>
        </div>
      </div>

      <div class="section" *ngIf="!hoveredCell">
        <div class="section-title">Zona Resaltada</div>
        <div class="hovered-region">
          <strong>üéØ Pasa mouse sobre una zona</strong>
          <p>Se mostrar√°n detalles de la zona aqu√≠ en tiempo real.</p>
        </div>
      </div>

      <!-- Temporal Filter -->
      <div class="section">
        <div class="filter-title">Filtro Temporal - Selecciona meses:</div>
        <div class="filter-group">
          <div class="checkbox-item" *ngFor="let month of months">
            <input type="checkbox" [id]="'month-' + month.id" [(ngModel)]="month.selected" (change)="onMonthFilterChange()">
            <label [for]="'month-' + month.id">{{ month.label }}</label>
          </div>
        </div>
      </div>

      <!-- Classes Filter -->
      <div class="section">
        <div class="filter-title">Clases Segmentadas:</div>
        <div class="filter-group">
          <div class="checkbox-item" *ngFor="let classType of classTypes">
            <input type="checkbox" [id]="'class-' + classType.id" [(ngModel)]="classType.selected" (change)="onClassFilterChange()">
            <label [for]="'class-' + classType.id">{{ classType.label }}</label>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="sigma-main-content">
      <div class="status-bar">
        <span>{{ getStatusMessage() }}</span>
      </div>

      <!-- Month tabs -->
      <div class="tab-container" *ngIf="getSelectedMonths().length > 1">
        <div class="tab" 
             *ngFor="let month of getSelectedMonths()" 
             [class.active]="activeMonth === month.id"
             (click)="setActiveMonth(month.id)">
          üìç {{ month.label }}
        </div>
      </div>

      <div class="content-wrapper">
        <!-- Map Section -->
        <div class="map-section">
          <div class="map-area">
            <div class="map-visualization">
              <div class="map-cell" 
                   *ngFor="let cell of getFilteredCells()" 
                   [class]="getCellClass(cell)"
                   [class.selected]="cell.selected"
                   (mouseenter)="onCellHover(cell)"
                   (mouseleave)="onCellLeave()"
                   (click)="onCellClick(cell)">
                <div class="map-label">{{ cell.name }}</div>
              </div>
            </div>

            <!-- Legend -->
            <div class="legend-box">
              <div class="legend-header">Leyenda</div>
              <div class="legend-item" *ngFor="let classType of classTypes">
                <div class="legend-color" [style.background-color]="classType.color"></div>
                <span [class.disabled]="!classType.selected">{{ classType.label }}</span>
              </div>
            </div>

            <!-- Info box that shows on hover -->
            <div class="info-box" [class.visible]="hoveredCell">
              <div class="info-box-title">{{ hoveredCell?.name || 'Zona' }}</div>
              <div class="info-box-stat"><strong>Tipo:</strong> <span>{{ hoveredCell?.type || '-' }}</span></div>
              <div class="info-box-stat"><strong>√Årea:</strong> <span>{{ hoveredCell?.area || '-' }}</span></div>
            </div>
          </div>
        </div>

        <!-- Dashboard Section -->
        <div class="dashboard-section">
          <!-- Overview Card -->
          <div class="dashboard-card">
            <div class="dashboard-card-title">üìä {{ getDashboardTitle() }}</div>
            <div class="card-stat">
              <span class="stat-label">{{ getStatLabel() }}:</span>
              <span class="stat-value large">{{ getVisibleCellsCount() }}</span>
            </div>
            <div class="card-stat">
              <span class="stat-label">Total de celdas:</span>
              <span class="stat-value">20</span>
            </div>
            <div class="card-stat">
              <span class="stat-label">{{ getCoverageLabel() }}:</span>
              <span class="stat-value">{{ getCoveragePercentage() }}%</span>
            </div>
          </div>

          <!-- Class Distribution Card -->
          <div class="dashboard-card">
            <div class="dashboard-card-title">üéØ Distribuci√≥n por Clase</div>
            <div *ngFor="let stat of getClassDistribution()">
              <div class="card-stat">
                <span class="stat-label">{{ stat.icon }} {{ stat.label }}</span>
                <span class="stat-value">{{ stat.percentage }}%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="stat.percentage" [style.background]="stat.gradient"></div>
              </div>
            </div>
          </div>

          <!-- Statistics Card -->
          <div class="dashboard-card">
            <div class="dashboard-card-title">üìà Estad√≠sticas Detalladas</div>
            <div class="chart-container">
              <div class="chart-bar" *ngFor="let bar of getChartData()">
                <div class="bar" [style.height.%]="bar.height" [style.background]="bar.gradient"></div>
                <div class="bar-label">{{ bar.label }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="bottom-toolbar">
        <div class="toolbar-info">
          {{ getToolbarInfo() }}
        </div>
        <div class="toolbar-buttons">
          <button class="btn-secondary" (click)="clearFilters()">Limpiar Filtros</button>
          <button class="btn-primary" (click)="downloadReport()">Descargar Informe</button>
        </div>
      </div>
    </main>
  </div>
</div>
