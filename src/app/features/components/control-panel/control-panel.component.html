<aside class="sigma-sidebar">
  <h2>Panel de Control</h2>

  <div class="section">
    <div class="section-title">Cargar Escena TIFF</div>
    <div class="upload-area" (click)="fileInput.click()">
      <div class="upload-icon"><i class="pi pi-upload"></i></div>
      <p>Selecciona archivo TIFF/GeoTIFF</p>
      <p class="upload-hint">{{ selectedFile?.name || 'Ningún archivo seleccionado' }}</p>
    </div>
    <input #fileInput type="file" accept=".tiff,.tif" (change)="onFileSelect($event)" hidden>
    
    <div class="form-group">
      <label>Fecha de Captura</label>
      <input type="date" [(ngModel)]="captureDate" [disabled]="isLoading">
    </div>
    
    <div class="form-group">
      <label>Código EPSG</label>
      <input type="number" [(ngModel)]="epsg" [disabled]="isLoading" placeholder="32717">
      <small class="hint">UTM Zone 17S para Ecuador (EPSG:32717)</small>
    </div>
    
    <div class="form-group">
      <label>Sensor</label>
      <input type="text" [(ngModel)]="sensor" [disabled]="isLoading" placeholder="drone_dji_phantom">
    </div>
    
    <div class="form-group">
      <label>Región ID</label>
      <select [(ngModel)]="regionId" [disabled]="isLoading">
        <option value="region_norte">Región Norte</option>
        <option value="region_sur">Región Sur</option>
        <option value="region_este">Región Este</option>
        <option value="region_oeste">Región Oeste</option>
      </select>
    </div>
    
    <button class="btn-upload" 
            (click)="onUploadScene()" 
            [disabled]="!canUpload">
      <i class="pi pi-cloud-upload"></i>
      {{ isLoading ? 'Cargando...' : 'Cargar y Procesar' }}
    </button>
    
    <button class="btn-segment" 
            *ngIf="canRunSegmentation"
            (click)="onRunSegmentation()" 
            [disabled]="isLoading">
      <i class="pi pi-cog"></i>
      {{ isLoading ? 'Segmentando...' : 'Ejecutar Segmentación' }}
    </button>
  </div>

  <div class="section">
    <div class="section-title">Segmento Resaltado</div>
    <div class="hovered-region" *ngIf="hoveredFeature; else hoveredFallback">
      <strong><i class="pi pi-map-marker"></i> {{ hoveredFeature.properties.className }}</strong>
      <p><strong>Área:</strong> {{ hoveredFeature.properties.areaM2.toFixed(2) }} m²</p>
      <p><strong>Confianza:</strong> {{ (hoveredFeature.properties.confidence * 100).toFixed(1) }}%</p>
      <p><strong>Período:</strong> {{ hoveredFeature.properties.periodo }}</p>
    </div>
    <ng-template #hoveredFallback>
      <div class="hovered-region">
        <strong><i class="pi pi-map-marker"></i> Pasa mouse sobre un segmento</strong>
        <p>Se mostrarán detalles del segmento aquí.</p>
      </div>
    </ng-template>
  </div>

  <div class="section">
    <div class="filter-title">Filtro Temporal - Selecciona meses:</div>
    <div class="filter-group">
      <div class="checkbox-item" *ngFor="let month of months">
        <input type="checkbox" [id]="'month-' + month.id" [(ngModel)]="month.selected" (change)="notifyMonthChange()">
        <label [for]="'month-' + month.id">{{ month.label }}</label>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="filter-title">Clases Segmentadas:</div>
    <div class="filter-group">
      <div class="checkbox-item" *ngFor="let classType of classTypes">
        <input type="checkbox" [id]="'class-' + classType.id" [(ngModel)]="classType.selected" (change)="notifyClassChange()">
        <label [for]="'class-' + classType.id">{{ classType.label }}</label>
      </div>
    </div>
  </div>
</aside>
